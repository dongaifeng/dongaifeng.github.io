---
title: 学习碎片
urlname: besg69
date: '2020-09-08 18:59:45 +0800'
tags: []
categories: []
---

#### css module

```javascript
// app.css
.title {
  color: red;
}
// 声明全局样式 :global
:global(.title) {
  color: green;
}

// app.js
import React from 'react';
import styles from './App.css';

export default () => {
  return (
    <h1 className="title" className={styles.title}>
      Hello World
    </h1>
  );
};
```

```javascript
.className {
  background-color: blue;
}
// 让.title继承.className 。
.title {
  composes: className;
  color: red;
}

.title {
  composes: className from './another.css';
  color: red;
}
```

#### setState

setState 是批量执行的   同一个 setState 只会使用最后一个
在 componentDidUpdate 中可获取 this.state 最新值
或者使用 setState 回调函数
建议使用  `componentDidUpdate()`

```javascript
this.setState((state, props) => {
  return { counter: state.counter + props.step }; // 会跟state合并
});
```

#### useState useEffect

```javascript
const [count, setCount] = useState(0);
// effect在componentDidMount，componentDidUpdate起作用
// 返回的函数在componentWillUnmount起作用
// 数组里放的是依赖项 此数据改变 才会调用effect
useEffect(() => {
  const timer = setInterval(() => {
    aaa(new Date());
  });
  return () => clearInterval(timer);
}, [count]);
```

#### 生命周期

![image.png](https://cdn.nlark.com/yuque/0/2019/png/462392/1574763997084-4f4dc6d2-903c-4b6e-8e3b-0a1619ad52ad.png#align=left&display=inline&height=490&margin=%5Bobject%20Object%5D&name=image.png&originHeight=795&originWidth=469&size=158773&status=done&style=none&width=289)
`getDerivedStateFromProps`  会在调用 render 方法之前调用，并且在初始挂载及后续更新时都会被调用。它应返回一个对象来更新 state，如果返回 null 则不更新任何内容。
无权访问组件实例。

getSnapshotBeforeUpdate() render 之前调⽤。它使得组件能在发⽣更改之前从 DOM 中
捕获⼀些信息（例如，滚动位置）。此⽣命周期的任何返回值将作
为参数传递给 componentDidUpdate()。
